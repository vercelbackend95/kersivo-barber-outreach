import{j as s}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.DiEladB3.js";function gn({activeSection:e,onChangeSection:t,children:n}){return s.jsxs("div",{className:"admin-shell",children:[s.jsxs("aside",{className:"admin-sidebar","aria-label":"Admin sections",children:[s.jsx("h1",{className:"admin-sidebar-title",children:"Admin"}),s.jsxs("nav",{className:"admin-sidebar-nav",children:[s.jsx("button",{type:"button",className:`admin-sidebar-link ${e==="bookings"?"admin-sidebar-link--active":""}`,onClick:()=>t("bookings"),children:"Bookings"}),s.jsx("button",{type:"button",className:`admin-sidebar-link ${e==="shop"?"admin-sidebar-link--active":""}`,onClick:()=>t("shop"),children:"Shop"})]})]}),s.jsx("section",{className:"admin-main-content",children:n})]})}const bn={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xn=(e,t,n)=>{let a;const r=bn[e];return typeof r=="string"?a=r:t===1?a=r.one:a=r.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};function at(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const yn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},wn={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vn={date:at({formats:yn,defaultWidth:"full"}),time:at({formats:wn,defaultWidth:"full"}),dateTime:at({formats:jn,defaultWidth:"full"})},Nn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kn=(e,t,n,a)=>Nn[e];function be(e){return(t,n)=>{const a=n?.context?String(n.context):"standalone";let r;if(a==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,m=n?.width?String(n.width):d;r=e.formattingValues[m]||e.formattingValues[d]}else{const d=e.defaultWidth,m=n?.width?String(n.width):e.defaultWidth;r=e.values[m]||e.values[d]}const o=e.argumentCallback?e.argumentCallback(t):t;return r[o]}}const Sn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Dn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Cn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Mn={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Tn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},On={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Pn=(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},En={ordinalNumber:Pn,era:be({values:Sn,defaultWidth:"wide"}),quarter:be({values:Dn,defaultWidth:"wide",argumentCallback:e=>e-1}),month:be({values:Cn,defaultWidth:"wide"}),day:be({values:Mn,defaultWidth:"wide"}),dayPeriod:be({values:Tn,defaultWidth:"wide",formattingValues:On,defaultFormattingWidth:"wide"})};function xe(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],o=t.match(r);if(!o)return null;const d=o[0],m=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],p=Array.isArray(m)?Yn(m,g=>g.test(d)):In(m,g=>g.test(d));let b;b=e.valueCallback?e.valueCallback(p):p,b=n.valueCallback?n.valueCallback(b):b;const f=t.slice(d.length);return{value:b,rest:f}}}function In(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Yn(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Fn(e){return(t,n={})=>{const a=t.match(e.matchPattern);if(!a)return null;const r=a[0],o=t.match(e.parsePattern);if(!o)return null;let d=e.valueCallback?e.valueCallback(o[0]):o[0];d=n.valueCallback?n.valueCallback(d):d;const m=t.slice(r.length);return{value:d,rest:m}}}const An=/^(\d+)(th|st|nd|rd)?/i,Ln=/\d+/i,$n={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Wn={any:[/^b/i,/^(a|c)/i]},Bn={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Hn={any:[/1/i,/2/i,/3/i,/4/i]},Un={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Rn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_n={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qn={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Gn={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Xn={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Zn={ordinalNumber:Fn({matchPattern:An,parsePattern:Ln,valueCallback:e=>parseInt(e,10)}),era:xe({matchPatterns:$n,defaultMatchWidth:"wide",parsePatterns:Wn,defaultParseWidth:"any"}),quarter:xe({matchPatterns:Bn,defaultMatchWidth:"wide",parsePatterns:Hn,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xe({matchPatterns:Un,defaultMatchWidth:"wide",parsePatterns:Rn,defaultParseWidth:"any"}),day:xe({matchPatterns:_n,defaultMatchWidth:"wide",parsePatterns:qn,defaultParseWidth:"any"}),dayPeriod:xe({matchPatterns:Gn,defaultMatchWidth:"any",parsePatterns:Xn,defaultParseWidth:"any"})},zn={code:"en-US",formatDistance:xn,formatLong:vn,formatRelative:kn,localize:En,match:Zn,options:{weekStartsOn:0,firstWeekContainsDate:1}};let Qn={};function ve(){return Qn}const zt=6048e5,Vn=864e5,Ct=Symbol.for("constructDateFrom");function V(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Ct in e?e[Ct](t):e instanceof Date?new e.constructor(t):new Date(t)}function W(e,t){return V(t||e,e)}function Mt(e){const t=W(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Jn(e,...t){const n=V.bind(null,t.find(a=>typeof a=="object"));return t.map(n)}function Tt(e,t){const n=W(e,t?.in);return n.setHours(0,0,0,0),n}function Kn(e,t,n){const[a,r]=Jn(n?.in,e,t),o=Tt(a),d=Tt(r),m=+o-Mt(o),p=+d-Mt(d);return Math.round((m-p)/Vn)}function ea(e,t){const n=W(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function ta(e,t){const n=W(e,t?.in);return Kn(n,ea(n))+1}function je(e,t){const n=ve(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=W(e,t?.in),o=r.getDay(),d=(o<a?7:0)+o-a;return r.setDate(r.getDate()-d),r.setHours(0,0,0,0),r}function Le(e,t){return je(e,{...t,weekStartsOn:1})}function Qt(e,t){const n=W(e,t?.in),a=n.getFullYear(),r=V(n,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const o=Le(r),d=V(n,0);d.setFullYear(a,0,4),d.setHours(0,0,0,0);const m=Le(d);return n.getTime()>=o.getTime()?a+1:n.getTime()>=m.getTime()?a:a-1}function na(e,t){const n=Qt(e,t),a=V(e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),Le(a)}function aa(e,t){const n=W(e,t?.in),a=+Le(n)-+na(n);return Math.round(a/zt)+1}function Vt(e,t){const n=W(e,t?.in),a=n.getFullYear(),r=ve(),o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,d=V(t?.in||e,0);d.setFullYear(a+1,0,o),d.setHours(0,0,0,0);const m=je(d,t),p=V(t?.in||e,0);p.setFullYear(a,0,o),p.setHours(0,0,0,0);const b=je(p,t);return+n>=+m?a+1:+n>=+b?a:a-1}function sa(e,t){const n=ve(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=Vt(e,t),o=V(t?.in||e,0);return o.setFullYear(r,0,a),o.setHours(0,0,0,0),je(o,t)}function ra(e,t){const n=W(e,t?.in),a=+je(n,t)-+sa(n,t);return Math.round(a/zt)+1}function x(e,t){const n=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return n+a}const Q={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return x(t==="yy"?a%100:a,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):x(n+1,2)},d(e,t){return x(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return x(e.getHours()%12||12,t.length)},H(e,t){return x(e.getHours(),t.length)},m(e,t){return x(e.getMinutes(),t.length)},s(e,t){return x(e.getSeconds(),t.length)},S(e,t){const n=t.length,a=e.getMilliseconds(),r=Math.trunc(a*Math.pow(10,n-3));return x(r,t.length)}},ue={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ot={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const a=e.getFullYear(),r=a>0?a:1-a;return n.ordinalNumber(r,{unit:"year"})}return Q.y(e,t)},Y:function(e,t,n,a){const r=Vt(e,a),o=r>0?r:1-r;if(t==="YY"){const d=o%100;return x(d,2)}return t==="Yo"?n.ordinalNumber(o,{unit:"year"}):x(o,t.length)},R:function(e,t){const n=Qt(e);return x(n,t.length)},u:function(e,t){const n=e.getFullYear();return x(n,t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return x(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return x(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return Q.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return x(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=ra(e,a);return t==="wo"?n.ordinalNumber(r,{unit:"week"}):x(r,t.length)},I:function(e,t,n){const a=aa(e);return t==="Io"?n.ordinalNumber(a,{unit:"week"}):x(a,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Q.d(e,t)},D:function(e,t,n){const a=ta(e);return t==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):x(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),o=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return x(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),o=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return x(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=a===0?7:a;switch(t){case"i":return String(r);case"ii":return x(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(a===12?r=ue.noon:a===0?r=ue.midnight:r=a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(a>=17?r=ue.evening:a>=12?r=ue.afternoon:a>=4?r=ue.morning:r=ue.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return Q.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Q.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return t==="Ko"?n.ordinalNumber(a,{unit:"hour"}):x(a,t.length)},k:function(e,t,n){let a=e.getHours();return a===0&&(a=24),t==="ko"?n.ordinalNumber(a,{unit:"hour"}):x(a,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Q.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Q.s(e,t)},S:function(e,t){return Q.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return Et(a);case"XXXX":case"XX":return ee(a);case"XXXXX":case"XXX":default:return ee(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return Et(a);case"xxxx":case"xx":return ee(a);case"xxxxx":case"xxx":default:return ee(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Pt(a,":");case"OOOO":default:return"GMT"+ee(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Pt(a,":");case"zzzz":default:return"GMT"+ee(a,":")}},t:function(e,t,n){const a=Math.trunc(+e/1e3);return x(a,t.length)},T:function(e,t,n){return x(+e,t.length)}};function Pt(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),o=a%60;return o===0?n+String(r):n+String(r)+t+x(o,2)}function Et(e,t){return e%60===0?(e>0?"-":"+")+x(Math.abs(e)/60,2):ee(e,t)}function ee(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=x(Math.trunc(a/60),2),o=x(a%60,2);return n+r+t+o}const It=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Jt=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},ia=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return It(e,t);let o;switch(a){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",It(a,t)).replace("{{time}}",Jt(r,t))},oa={p:Jt,P:ia},ca=/^D+$/,la=/^Y+$/,da=["D","DD","YY","YYYY"];function ua(e){return ca.test(e)}function ma(e){return la.test(e)}function ha(e,t,n){const a=fa(e,t,n);if(console.warn(a),da.includes(e))throw new RangeError(a)}function fa(e,t,n){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function pa(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ga(e){return!(!pa(e)&&typeof e!="number"||isNaN(+W(e)))}const ba=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,xa=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ya=/^'([^]*?)'?$/,wa=/''/g,ja=/[a-zA-Z]/;function va(e,t,n){const a=ve(),r=n?.locale??a.locale??zn,o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,d=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,m=W(e,n?.in);if(!ga(m))throw new RangeError("Invalid time value");let p=t.match(xa).map(f=>{const g=f[0];if(g==="p"||g==="P"){const M=oa[g];return M(f,r.formatLong)}return f}).join("").match(ba).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const g=f[0];if(g==="'")return{isToken:!1,value:Na(f)};if(Ot[g])return{isToken:!0,value:f};if(g.match(ja))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:f}});r.localize.preprocessor&&(p=r.localize.preprocessor(m,p));const b={firstWeekContainsDate:o,weekStartsOn:d,locale:r};return p.map(f=>{if(!f.isToken)return f.value;const g=f.value;(!n?.useAdditionalWeekYearTokens&&ma(g)||!n?.useAdditionalDayOfYearTokens&&ua(g))&&ha(g,t,String(e));const M=Ot[g[0]];return M(m,g,r.localize,b)}).join("")}function Na(e){const t=e.match(ya);return t?t[1].replace(wa,"'"):e}function ka(){return Object.assign({},ve())}function Yt(e,t,n){const a=ka(),r=Ca(e,n.timeZone,n.locale??a.locale);return"formatToParts"in r?Sa(r,t):Da(r,t)}function Sa(e,t){const n=e.formatToParts(t);for(let a=n.length-1;a>=0;--a)if(n[a].type==="timeZoneName")return n[a].value}function Da(e,t){const n=e.format(t).replace(/\u200E/g,""),a=/ [\w-+ ]+$/.exec(n);return a?a[0].substr(1):""}function Ca(e,t,n){return new Intl.DateTimeFormat(n?[n.code,"en-US"]:void 0,{timeZone:t,timeZoneName:e})}function Ma(e,t){const n=Ia(t);return"formatToParts"in n?Oa(n,e):Pa(n,e)}const Ta={year:0,month:1,day:2,hour:3,minute:4,second:5};function Oa(e,t){try{const n=e.formatToParts(t),a=[];for(let r=0;r<n.length;r++){const o=Ta[n[r].type];o!==void 0&&(a[o]=parseInt(n[r].value,10))}return a}catch(n){if(n instanceof RangeError)return[NaN];throw n}}function Pa(e,t){const n=e.format(t),a=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[parseInt(a[3],10),parseInt(a[1],10),parseInt(a[2],10),parseInt(a[4],10),parseInt(a[5],10),parseInt(a[6],10)]}const st={},Ft=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),Ea=Ft==="06/25/2014, 00:00:00"||Ft==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";function Ia(e){return st[e]||(st[e]=Ea?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),st[e]}function mt(e,t,n,a,r,o,d){const m=new Date(0);return m.setUTCFullYear(e,t,n),m.setUTCHours(a,r,o,d),m}const At=36e5,Ya=6e4,rt={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function Be(e,t,n){if(!e)return 0;let a=rt.timezoneZ.exec(e);if(a)return 0;let r,o;if(a=rt.timezoneHH.exec(e),a)return r=parseInt(a[1],10),Lt(r)?-(r*At):NaN;if(a=rt.timezoneHHMM.exec(e),a){r=parseInt(a[2],10);const d=parseInt(a[3],10);return Lt(r,d)?(o=Math.abs(r)*At+d*Ya,a[1]==="+"?-o:o):NaN}if(La(e)){t=new Date(t||Date.now());const d=n?t:Fa(t),m=dt(d,e);return-(n?m:Aa(t,m,e))}return NaN}function Fa(e){return mt(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function dt(e,t){const n=Ma(e,t),a=mt(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime();let r=e.getTime();const o=r%1e3;return r-=o>=0?o:1e3+o,a-r}function Aa(e,t,n){let r=e.getTime()-t;const o=dt(new Date(r),n);if(t===o)return t;r-=o-t;const d=dt(new Date(r),n);return o===d?o:Math.max(o,d)}function Lt(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}const $t={};function La(e){if($t[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),$t[e]=!0,!0}catch{return!1}}const $a=60*1e3,Wa={X:function(e,t,n){const a=it(n.timeZone,e);if(a===0)return"Z";switch(t){case"X":return Wt(a);case"XXXX":case"XX":return me(a);case"XXXXX":case"XXX":default:return me(a,":")}},x:function(e,t,n){const a=it(n.timeZone,e);switch(t){case"x":return Wt(a);case"xxxx":case"xx":return me(a);case"xxxxx":case"xxx":default:return me(a,":")}},O:function(e,t,n){const a=it(n.timeZone,e);switch(t){case"O":case"OO":case"OOO":return"GMT"+Ba(a,":");case"OOOO":default:return"GMT"+me(a,":")}},z:function(e,t,n){switch(t){case"z":case"zz":case"zzz":return Yt("short",e,n);case"zzzz":default:return Yt("long",e,n)}}};function it(e,t){const n=e?Be(e,t,!0)/$a:t?.getTimezoneOffset()??0;if(Number.isNaN(n))throw new RangeError("Invalid time zone specified: "+e);return n}function $e(e,t){const n=e<0?"-":"";let a=Math.abs(e).toString();for(;a.length<t;)a="0"+a;return n+a}function me(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=$e(Math.floor(a/60),2),o=$e(Math.floor(a%60),2);return n+r+t+o}function Wt(e,t){return e%60===0?(e>0?"-":"+")+$e(Math.abs(e)/60,2):me(e,t)}function Ba(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.floor(a/60),o=a%60;return o===0?n+String(r):n+String(r)+t+$e(o,2)}function Bt(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+e-+t}const Kt=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,ot=36e5,Ht=6e4,Ha=2,T={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Kt};function We(e,t={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);const n=t.additionalDigits==null?Ha:Number(t.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(Object.prototype.toString.call(e)!=="[object String]")return new Date(NaN);const a=Ua(e),{year:r,restDateString:o}=Ra(a.date,n),d=_a(o,r);if(d===null||isNaN(d.getTime()))return new Date(NaN);if(d){const m=d.getTime();let p=0,b;if(a.time&&(p=qa(a.time),p===null||isNaN(p)))return new Date(NaN);if(a.timeZone||t.timeZone){if(b=Be(a.timeZone||t.timeZone,new Date(m+p)),isNaN(b))return new Date(NaN)}else b=Bt(new Date(m+p)),b=Bt(new Date(m+p+b));return new Date(m+p+b)}else return new Date(NaN)}function Ua(e){const t={};let n=T.dateTimePattern.exec(e),a;if(n?(t.date=n[1],a=n[3]):(n=T.datePattern.exec(e),n?(t.date=n[1],a=n[2]):(t.date=null,a=e)),a){const r=T.timeZone.exec(a);r?(t.time=a.replace(r[1],""),t.timeZone=r[1].trim()):t.time=a}return t}function Ra(e,t){if(e){const n=T.YYY[t],a=T.YYYYY[t];let r=T.YYYY.exec(e)||a.exec(e);if(r){const o=r[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(r=T.YY.exec(e)||n.exec(e),r){const o=r[1];return{year:parseInt(o,10)*100,restDateString:e.slice(o.length)}}}return{year:null}}function _a(e,t){if(t===null)return null;let n,a,r;if(!e||!e.length)return n=new Date(0),n.setUTCFullYear(t),n;let o=T.MM.exec(e);if(o)return n=new Date(0),a=parseInt(o[1],10)-1,Rt(t,a)?(n.setUTCFullYear(t,a),n):new Date(NaN);if(o=T.DDD.exec(e),o){n=new Date(0);const d=parseInt(o[1],10);return Za(t,d)?(n.setUTCFullYear(t,0,d),n):new Date(NaN)}if(o=T.MMDD.exec(e),o){n=new Date(0),a=parseInt(o[1],10)-1;const d=parseInt(o[2],10);return Rt(t,a,d)?(n.setUTCFullYear(t,a,d),n):new Date(NaN)}if(o=T.Www.exec(e),o)return r=parseInt(o[1],10)-1,_t(r)?Ut(t,r):new Date(NaN);if(o=T.WwwD.exec(e),o){r=parseInt(o[1],10)-1;const d=parseInt(o[2],10)-1;return _t(r,d)?Ut(t,r,d):new Date(NaN)}return null}function qa(e){let t,n,a=T.HH.exec(e);if(a)return t=parseFloat(a[1].replace(",",".")),ct(t)?t%24*ot:NaN;if(a=T.HHMM.exec(e),a)return t=parseInt(a[1],10),n=parseFloat(a[2].replace(",",".")),ct(t,n)?t%24*ot+n*Ht:NaN;if(a=T.HHMMSS.exec(e),a){t=parseInt(a[1],10),n=parseInt(a[2],10);const r=parseFloat(a[3].replace(",","."));return ct(t,n,r)?t%24*ot+n*Ht+r*1e3:NaN}return null}function Ut(e,t,n){t=t||0,n=n||0;const a=new Date(0);a.setUTCFullYear(e,0,4);const r=a.getUTCDay()||7,o=t*7+n+1-r;return a.setUTCDate(a.getUTCDate()+o),a}const Ga=[31,28,31,30,31,30,31,31,30,31,30,31],Xa=[31,29,31,30,31,30,31,31,30,31,30,31];function en(e){return e%400===0||e%4===0&&e%100!==0}function Rt(e,t,n){if(t<0||t>11)return!1;if(n!=null){if(n<1)return!1;const a=en(e);if(a&&n>Xa[t]||!a&&n>Ga[t])return!1}return!0}function Za(e,t){if(t<1)return!1;const n=en(e);return!(n&&t>366||!n&&t>365)}function _t(e,t){return!(e<0||e>52||t!=null&&(t<0||t>6))}function ct(e,t,n){return!(e<0||e>=25||t!=null&&(t<0||t>=60)||n!=null&&(n<0||n>=60))}const za=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function Qa(e,t,n={}){t=String(t);const a=t.match(za);if(a){const r=We(n.originalDate||e,n);t=a.reduce(function(o,d){if(d[0]==="'")return o;const m=o.indexOf(d),p=o[m-1]==="'",b=o.replace(d,"'"+Wa[d[0]](r,d,n)+"'");return p?b.substring(0,m-1)+b.substring(m+1):b},t)}return va(e,t,n)}function ht(e,t,n){e=We(e,n);const a=Be(t,e,!0),r=new Date(e.getTime()-a),o=new Date(0);return o.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),o.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),o}function ft(e,t,n,a){return a={...a,timeZone:t,originalDate:e},Qa(ht(e,t,{timeZone:a.timeZone}),n,a)}function te(e,t,n){if(typeof e=="string"&&!e.match(Kt))return We(e,{...n,timeZone:t});e=We(e,n);const a=mt(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()).getTime(),r=Be(t,new Date(a));return new Date(a+r)}const D="Europe/London",we=15,Va=15e3,Ja=1e3,Ka=2e3;function es(){return ft(new Date,D,"yyyy-MM-dd")}function qt(e,t){const n=te(`${e}T00:00:00.000`,D);return ft(new Date(n.getTime()+t*24*60*60*1e3),D,"yyyy-MM-dd")}function ye(e){const t=es();return e==="overall"?{from:"",to:""}:e==="last30"?{from:qt(t,-30),to:t}:{from:qt(t,-7),to:t}}function ts(e,t){const n=Date.now(),a=new Date(e).getTime(),r=new Date(t).getTime();if(n>=a&&n<r)return"now";const o=a-n;if(o<=0)return"now";const d=Math.floor(o/6e4);if(d<60)return`in ${d} min`;const m=Math.floor(d/60),p=d%60;return p?`in ${m}h ${p}m`:`in ${m}h`}function ns(e){return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",timeZone:D})}function as(e){const t=Date.now();return e.filter(n=>n.status==="CONFIRMED").filter(n=>new Date(n.endAt).getTime()>t).sort((n,a)=>new Date(n.startAt).getTime()-new Date(a.startAt).getTime())}function ss(e,t){if(!e)return"never";const n=Math.floor((t-e)/1e3);return n<=4?"just now":n<60?`${n}s ago`:`${Math.floor(n/60)}m ago`}const ut=e=>e.trim().toLowerCase(),rs=e=>e.startsWith("CANCELLED"),is=e=>e.status==="CONFIRMED";function os(e,t){const n=ut(e.email??""),a=ut(e.fullName??"");return n===t?6:n.startsWith(t)?5:n.includes(t)?4:a===t?3:a.startsWith(t)?2:a.includes(t)?1:0}function cs(e,t){return t==="confirmed"?e.status==="CONFIRMED"&&!e.rescheduledAt:t==="rescheduled"?e.status==="CONFIRMED"&&!!e.rescheduledAt:t==="pending"?e.status==="PENDING_CONFIRMATION":rs(e.status)}function Ae(e,t=we){const n=ht(e,D),a=n.getFullYear(),r=n.getMonth(),o=n.getDate(),d=n.getHours(),m=n.getMinutes(),p=Math.ceil(m/t)*t;return te(new Date(a,r,o,d,p,0,0),D)}function Gt(e){return ft(e,D,"yyyy-MM-dd'T'HH:mm")}function ls(e,t){return`${new Date(e).toLocaleString("en-GB",{timeZone:D})} → ${new Date(t).toLocaleString("en-GB",{timeZone:D})}`}function ds(e){const t=ht(e,D),n=te(new Date(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0,0),D);if(e<n)return{startAt:n,endAt:new Date(n.getTime()+30*6e4)};const a=Ae(e,we);return{startAt:a,endAt:new Date(a.getTime()+30*6e4)}}function us({isActive:e}){const[t,n]=l.useState(""),[a,r]=l.useState(!1),[o,d]=l.useState(!0),[m,p]=l.useState([]),[b,f]=l.useState([]),[g,M]=l.useState([]),[y,E]=l.useState(""),[h,k]=l.useState([]),[he,O]=l.useState(!1),[ne,I]=l.useState(null),[He,U]=l.useState(()=>Date.now()),[ae,fe]=l.useState(""),[R,X]=l.useState("confirmed"),[w,_]=l.useState("today"),[se,Z]=l.useState("bookings"),[re,Ne]=l.useState("all"),[$,q]=l.useState("last7"),[z,S]=l.useState(()=>ye("last7").from),[J,pe]=l.useState(()=>ye("last7").to),[ke,ie]=l.useState(null),[ge,K]=l.useState(!1),[G,oe]=l.useState(!1),[Y,Se]=l.useState(null),[De,Ce]=l.useState(""),[Me,Te]=l.useState(""),[Oe,Ue]=l.useState(""),[Pe,ce]=l.useState(null),[c,u]=l.useState("all"),[v,C]=l.useState(""),[P,F]=l.useState(""),[Ee,Ie]=l.useState(!1),[Re,tn]=l.useState(()=>Gt(Ae(new Date,we))),[_e,nn]=l.useState(()=>Gt(new Date(Ae(new Date,we).getTime()+30*6e4))),[qe,an]=l.useState(!1),[Ge,Xe]=l.useState(null),[A,pt]=l.useState(null),[sn,Ze]=l.useState(!1),[gt,bt]=l.useState(""),[ze,xt]=l.useState(""),[yt,wt]=l.useState(!1),Qe=l.useRef(!1),Ve=l.useRef(!1),jt=l.useRef(new Map),Je=l.useRef(null),le=l.useCallback(async()=>{const i=await fetch("/api/admin/timeblocks?range=today",{credentials:"same-origin"});if(i.ok){const j=await i.json();M(j.timeBlocks??[])}},[]),vt=l.useCallback(async()=>{const i=await fetch("/api/admin/barbers",{credentials:"same-origin"});if(i.ok){const j=await i.json();f(j.barbers??[])}},[]),Ye=l.useCallback(async()=>{if(!a)return;Ce("");const i=await fetch("/api/admin/reports?range=week",{credentials:"same-origin"});if(i.status===401){Ve.current=!0,r(!1),E("Session expired. Please log in again.");return}if(!i.ok){Ce("Could not load reports right now.");return}const j=await i.json();Se(j)},[a]),L=l.useCallback(async(i=!1)=>{if(!(!a||!e||Ve.current||Qe.current)){w==="history"&&!i&&ie(null),Qe.current=!0,O(!0);try{const j=(()=>{if(w==="today")return"/api/admin/bookings?range=today";if(w==="all")return"/api/admin/bookings";const N=new URLSearchParams({view:"history",barberId:re,limit:"50"});return $!=="custom"&&N.set("preset",$),z&&N.set("from",z),J&&N.set("to",J),i&&ke&&N.set("cursor",ke),`/api/admin/bookings?${N.toString()}`})(),B=await fetch(j,{credentials:"same-origin"});if(B.status===401){Ve.current=!0,r(!1),E("Session expired. Please log in again.");return}if(!B.ok)throw new Error("Fetch failed");const Fe=await B.json(),kt=Fe.bookings??[],nt=i?[...m,...kt]:kt,St=new Map(nt.map(N=>[N.id,[N.id,N.fullName,N.email,N.status,N.startAt,N.endAt,N.rescheduledAt??"",N.barber?.name??"",N.service?.name??"",N.clientId??""].join("|")])),Dt=nt.filter(N=>jt.current.get(N.id)!==St.get(N.id)).map(N=>N.id);p(nt),w==="history"&&(K(!!Fe.hasMore),ie(Fe.cursor??null)),jt.current=St,I(Date.now()),Dt.length&&(k(Dt),Je.current&&window.clearTimeout(Je.current),Je.current=window.setTimeout(()=>k([]),Ka))}catch{E("Could not refresh bookings right now.")}finally{Qe.current=!1,O(!1),oe(!1)}}},[w,m,re,ke,z,$,J,a]),rn=l.useCallback(async()=>{!ge||G||w!=="history"||(oe(!0),await L(!0))},[w,L,ge,G]);l.useEffect(()=>{(async()=>{try{const i=await fetch("/api/admin/session",{credentials:"same-origin"});r(i.ok)}finally{d(!1)}})()},[]),l.useEffect(()=>{if(!a||!e)return;w!=="history"&&L(),vt(),le(),Ye();const i=window.setInterval(()=>{w!=="history"&&L(),le(),Ye()},Va);return()=>window.clearInterval(i)},[w,L,vt,Ye,le,e,a]),l.useEffect(()=>{if(!a||!e)return;const i=window.setInterval(()=>U(Date.now()),Ja);return()=>window.clearInterval(i)},[e,a]),l.useEffect(()=>{if(!a||!e||w!=="history")return;const i=window.setTimeout(()=>{L()},300);return()=>window.clearTimeout(i)},[w,L,re,z,$,J,e,a]);const Ke=l.useMemo(()=>ut(ae),[ae]),de=l.useMemo(()=>as(m),[m])[0]??null,et=l.useMemo(()=>m.filter(i=>cs(i,R)),[m,R]),on=l.useMemo(()=>Ke?et.map((i,j)=>({booking:i,score:os(i,Ke),index:j})).filter(i=>i.score>0).sort((i,j)=>j.score-i.score).map(i=>i.booking):et,[et,Ke]);async function Nt(i){if(!i)return;Xe(i),Ze(!0),bt("");const j=await fetch(`/api/admin/clients/${i}`,{credentials:"same-origin"});if(!j.ok){bt("Could not load client profile."),Ze(!1);return}const B=await j.json();pt(B),xt(B.client.notes??""),Ze(!1)}async function cn(){if(!Ge)return;wt(!0),(await fetch(`/api/admin/clients/${Ge}/notes`,{method:"POST",credentials:"same-origin",headers:{"content-type":"application/json"},body:JSON.stringify({notes:ze})})).ok&&A&&pt({...A,client:{...A.client,notes:ze}}),wt(!1)}async function ln(){const i=await fetch("/api/admin/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({secret:t})});r(i.ok),i.ok||E("Invalid secret")}async function dn(){await fetch("/api/admin/logout",{method:"POST",credentials:"same-origin"}),p([]),r(!1)}async function un(i){ce(i.id),(await fetch("/api/admin/bookings/cancel",{method:"POST",credentials:"same-origin",headers:{"content-type":"application/json"},body:JSON.stringify({bookingId:i.id})})).ok?(Te("Booking cancelled successfully."),await L()):Ue("Could not cancel booking right now."),ce(null)}async function tt(i,j,B){if(F(""),C(""),!(await fetch("/api/admin/timeblocks/create",{method:"POST",credentials:"same-origin",headers:{"content-type":"application/json"},body:JSON.stringify({title:i,startAt:j.toISOString(),endAt:B.toISOString(),barberId:c==="all"?null:c})})).ok){F("Could not create time block.");return}C("Time block created."),await Promise.all([L(),le()])}async function mn(){const i=Ae(new Date,we),j=new Date(i.getTime()+30*6e4);await tt("Blocked",i,j)}async function hn(){const{startAt:i,endAt:j}=ds(new Date);await tt("Lunch",i,j)}async function fn(i){i.preventDefault();const j=te(qe?new Date(`${Re.slice(0,10)}T00:00:00`):new Date(Re),D),B=te(qe?new Date(`${_e.slice(0,10)}T23:59:00`):new Date(_e),D);await tt("Holiday",j,B),Ie(!1)}async function pn(i){if(F(""),C(""),!(await fetch("/api/admin/timeblocks/delete",{method:"POST",credentials:"same-origin",headers:{"content-type":"application/json"},body:JSON.stringify({id:i})})).ok){F("Could not remove time block.");return}C("Time block removed."),await Promise.all([L(),le()])}return e?o?s.jsxs("section",{className:"surface booking-shell",children:[s.jsx("h1",{children:"Admin"}),s.jsx("p",{className:"muted",children:"Checking session…"})]}):a?s.jsxs("section",{className:"surface booking-shell",children:[s.jsx("h1",{children:"Admin Dashboard"}),s.jsxs("div",{className:"admin-next-block",children:[s.jsx("p",{className:"admin-next-primary",children:w==="today"?`Today: ${m.length} bookings`:w==="all"?`All: ${m.length} bookings`:`History: ${m.length} bookings`}),de&&w!=="history"&&s.jsxs("p",{className:"admin-next-secondary",children:["Next: ",de.barber?.name," — ",de.service?.name," — ",ns(de.startAt)," (",ts(de.startAt,de.endAt),")"]})]}),s.jsxs("div",{className:"admin-refresh-row",children:[s.jsxs("p",{className:"muted admin-last-updated",children:["Last updated: ",ss(ne,He)]}),s.jsxs("div",{className:"admin-refresh-controls",children:[s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>{L(),le(),Ye()},disabled:he,children:"Refresh"}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void dn(),children:"Logout"})]})]}),s.jsxs("div",{className:"admin-view-tabs",role:"tablist","aria-label":"Admin sections",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${se==="bookings"?"admin-filter-tab--active":""}`,onClick:()=>Z("bookings"),children:"Bookings"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${se==="reports"?"admin-filter-tab--active":""}`,onClick:()=>Z("reports"),children:"Reports"})]}),Me&&s.jsx("p",{className:"admin-inline-success",children:Me}),Oe&&s.jsx("p",{className:"admin-inline-error",children:Oe}),se==="bookings"&&s.jsxs(s.Fragment,{children:[w==="today"&&s.jsxs("section",{className:"admin-quick-blocks",children:[s.jsx("h2",{children:"Quick blocks"}),s.jsxs("div",{className:"admin-quick-scope",children:[s.jsx("label",{htmlFor:"block-scope",children:"Applies to"}),s.jsxs("select",{id:"block-scope",value:c,onChange:i=>u(i.target.value),children:[s.jsx("option",{value:"all",children:"All barbers"}),b.map(i=>s.jsx("option",{value:i.id,children:i.name},i.id))]})]}),s.jsxs("div",{className:"admin-quick-actions",children:[s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void mn(),children:"Block 30 min"}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void hn(),children:"Lunch"}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>Ie(!0),children:"Holiday"})]}),v&&s.jsx("p",{className:"admin-inline-success",children:v}),P&&s.jsx("p",{className:"admin-inline-error",children:P}),s.jsx("h3",{children:"Today's blocks"}),s.jsx("ul",{className:"admin-blocks-list",children:g.length===0?s.jsx("li",{className:"muted",children:"No blocks yet."}):g.map(i=>s.jsxs("li",{children:[s.jsxs("div",{children:[s.jsx("strong",{children:i.title}),s.jsxs("p",{className:"muted",children:[i.barber?.name??"All barbers"," · ",ls(i.startAt,i.endAt)]})]}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void pn(i.id),children:"Remove"})]},i.id))})]}),s.jsxs("div",{className:"admin-view-tabs admin-view-tabs--three",role:"tablist","aria-label":"Admin views",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${w==="today"?"admin-filter-tab--active":""}`,onClick:()=>_("today"),children:"Today"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${w==="all"?"admin-filter-tab--active":""}`,onClick:()=>_("all"),children:"All bookings"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${w==="history"?"admin-filter-tab--active":""}`,onClick:()=>_("history"),children:"History"})]}),w==="history"&&s.jsxs("section",{className:"admin-history-filters",children:[s.jsxs("div",{className:"admin-history-row",children:[s.jsx("label",{htmlFor:"history-barber",children:"Barber"}),s.jsxs("select",{id:"history-barber",value:re,onChange:i=>Ne(i.target.value),children:[s.jsx("option",{value:"all",children:"All barbers"}),b.map(i=>s.jsx("option",{value:i.id,children:i.name},i.id))]})]}),s.jsxs("div",{className:"admin-filter-tabs admin-filter-tabs--history",role:"tablist","aria-label":"History range presets",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${$==="last7"?"admin-filter-tab--active":""}`,onClick:()=>{const i=ye("last7");q("last7"),S(i.from),pe(i.to)},children:"Last 7 days"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${$==="last30"?"admin-filter-tab--active":""}`,onClick:()=>{const i=ye("last30");q("last30"),S(i.from),pe(i.to)},children:"Last 30 days"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${$==="overall"?"admin-filter-tab--active":""}`,onClick:()=>{const i=ye("overall");q("overall"),S(i.from),pe(i.to)},children:"Overall"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${$==="custom"?"admin-filter-tab--active":""}`,onClick:()=>q("custom"),children:"Custom"})]}),s.jsxs("div",{className:"admin-history-date-grid",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"history-from",children:"From"}),s.jsx("input",{id:"history-from",type:"date",value:z,onChange:i=>{S(i.target.value),q("custom")}})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"history-to",children:"To"}),s.jsx("input",{id:"history-to",type:"date",value:J,onChange:i=>{pe(i.target.value),q("custom")}})]}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void L(),children:"Apply"})]})]}),s.jsxs("div",{className:"admin-filter-tabs",role:"tablist","aria-label":"Booking status filters",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${R==="confirmed"?"admin-filter-tab--active":""}`,onClick:()=>X("confirmed"),children:"Confirmed"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${R==="rescheduled"?"admin-filter-tab--active":""}`,onClick:()=>X("rescheduled"),children:"Rescheduled"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${R==="pending"?"admin-filter-tab--active":""}`,onClick:()=>X("pending"),children:"Pending"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${R==="cancelled"?"admin-filter-tab--active":""}`,onClick:()=>X("cancelled"),children:"Cancelled"})]}),s.jsx("div",{className:"admin-search-row",children:s.jsx("input",{type:"search",value:ae,onChange:i=>fe(i.target.value),placeholder:"Search by client name or email…","aria-label":"Search by client name or email"})}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Client"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Service"}),s.jsx("th",{children:"Barber"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Start"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:on.map(i=>s.jsxs("tr",{className:h.includes(i.id)?"admin-row--updated":"",children:[s.jsx("td",{children:s.jsx("button",{type:"button",className:"admin-link-button",onClick:()=>void Nt(i.clientId),children:i.fullName})}),s.jsx("td",{children:s.jsx("button",{type:"button",className:"admin-link-button",onClick:()=>void Nt(i.clientId),children:i.email})}),s.jsx("td",{children:i.service?.name}),s.jsx("td",{children:i.barber?.name}),s.jsx("td",{children:i.status==="CONFIRMED"&&i.rescheduledAt?"CONFIRMED · RESCHEDULED":i.status}),s.jsx("td",{children:new Date(i.startAt).toLocaleString("en-GB",{timeZone:D})}),s.jsx("td",{children:is(i)?s.jsx("button",{type:"button",className:"btn btn--secondary admin-cancel-btn",onClick:()=>void un(i),disabled:Pe===i.id,children:Pe===i.id?"Cancelling…":"Cancel"}):null})]},i.id))})]}),w==="history"&&ge&&s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void rn(),disabled:G,children:G?"Loading…":"Load more"})]}),se==="reports"&&s.jsxs("section",{className:"admin-reports","aria-live":"polite",children:[s.jsx("h2",{children:"Reports"}),s.jsx("p",{className:"muted",children:"This week (Europe/London)"}),De&&s.jsx("p",{className:"admin-inline-error",children:De}),s.jsxs("div",{className:"admin-reports-grid",children:[s.jsxs("article",{className:"admin-kpi-card",children:[s.jsx("p",{className:"admin-kpi-label",children:"Bookings this week"}),s.jsx("p",{className:"admin-kpi-value",children:Y?.bookingsThisWeek??0})]}),s.jsxs("article",{className:"admin-kpi-card",children:[s.jsx("p",{className:"admin-kpi-label",children:"Cancelled rate"}),s.jsx("p",{className:"admin-kpi-value",children:`${(Y?.cancelledRate??0).toFixed(1)}%`})]}),s.jsxs("article",{className:"admin-kpi-card",children:[s.jsx("p",{className:"admin-kpi-label",children:"Most popular service"}),s.jsx("p",{className:"admin-kpi-value",children:Y?.mostPopularService?`${Y.mostPopularService.name} (${Y.mostPopularService.count})`:"No confirmed bookings"})]}),s.jsxs("article",{className:"admin-kpi-card",children:[s.jsx("p",{className:"admin-kpi-label",children:"Busiest barber"}),s.jsx("p",{className:"admin-kpi-value",children:Y?.busiestBarber?`${Y.busiestBarber.name} (${Y.busiestBarber.count})`:"No confirmed bookings"})]})]})]}),Ee&&s.jsx("div",{className:"admin-client-modal-backdrop",role:"presentation",onClick:()=>Ie(!1),children:s.jsxs("form",{className:"admin-client-modal",onSubmit:i=>void fn(i),onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"admin-client-modal-head",children:[s.jsx("h2",{children:"Holiday block"}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>Ie(!1),children:"Close"})]}),s.jsx("label",{htmlFor:"holiday-start",children:"Start"}),s.jsx("input",{id:"holiday-start",type:"datetime-local",value:Re,onChange:i=>tn(i.target.value),required:!0}),s.jsx("label",{htmlFor:"holiday-end",children:"End"}),s.jsx("input",{id:"holiday-end",type:"datetime-local",value:_e,onChange:i=>nn(i.target.value),required:!0}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:qe,onChange:i=>an(i.target.checked)})," All day"]}),s.jsx("button",{type:"submit",className:"btn btn--primary",children:"Create holiday block"})]})}),Ge&&s.jsx("div",{className:"admin-client-modal-backdrop",role:"presentation",onClick:()=>Xe(null),children:s.jsxs("div",{className:"admin-client-modal",role:"dialog","aria-modal":"true","aria-label":"Client profile",onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"admin-client-modal-head",children:[s.jsx("h2",{children:"Client profile"}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>Xe(null),children:"Close"})]}),sn&&s.jsx("p",{className:"muted",children:"Loading…"}),gt&&s.jsx("p",{className:"admin-inline-error",children:gt}),A&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx("strong",{children:A.client.fullName||"Unnamed client"}),s.jsx("br",{}),A.client.email,s.jsx("br",{}),A.client.phone||"No phone"]}),s.jsxs("div",{className:"admin-client-stats",children:[s.jsxs("p",{children:["Total visits: ",A.stats.totalBookings]}),s.jsxs("p",{children:["Last visit: ",A.stats.lastBookingAt?new Date(A.stats.lastBookingAt).toLocaleString("en-GB",{timeZone:D}):"—"]}),s.jsxs("p",{children:["Cancelled: ",A.stats.cancelledCount]})]}),s.jsx("h3",{children:"Recent bookings"}),s.jsx("ul",{className:"admin-client-bookings",children:A.recentBookings.map(i=>s.jsxs("li",{children:[new Date(i.startAt).toLocaleString("en-GB",{timeZone:D})," · ",i.status," · ",i.service?.name," · ",i.barber?.name]},i.id))}),s.jsx("label",{htmlFor:"client-notes",children:"Notes"}),s.jsx("textarea",{id:"client-notes",value:ze,onChange:i=>xt(i.target.value),rows:5}),s.jsx("button",{type:"button",className:"btn btn--primary",onClick:()=>void cn(),disabled:yt,children:yt?"Saving…":"Save notes"})]})]})})]}):s.jsxs("section",{className:"surface booking-shell",children:[s.jsx("h1",{children:"Admin"}),s.jsx("label",{children:"Admin secret"}),s.jsx("input",{type:"password",value:t,onChange:i=>n(i.target.value)}),s.jsx("button",{className:"btn btn--primary",onClick:ln,children:"Login"}),y&&s.jsx("p",{children:y})]}):null}const lt={name:"",description:"",priceGbp:"",imageUrl:"",active:!0,featured:!1,sortOrder:0};function H(e){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e/100)}function ms(e){const t=e.replace(/,/g,".").trim();if(!t)return 0;const n=Number.parseFloat(t);return Number.isFinite(n)?Math.round(n*100):0}function hs(){return new Intl.DateTimeFormat("en-CA",{timeZone:"Europe/London",year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date)}function Xt(e){const t=Number(e),n=new Date,a=new Intl.DateTimeFormat("en-CA",{timeZone:"Europe/London",year:"numeric",month:"2-digit",day:"2-digit"}).format(n),r=new Date;return r.setUTCDate(r.getUTCDate()-(t-1)),{from:new Intl.DateTimeFormat("en-CA",{timeZone:"Europe/London",year:"numeric",month:"2-digit",day:"2-digit"}).format(r),to:a}}function fs({series:e}){const a={top:20,right:20,bottom:36,left:54},r=["var(--accent)","var(--fg)","var(--muted)","var(--accent-hover)"],o=e.flatMap(h=>h.points),d=Array.from(new Set(o.map(h=>h.date))).sort((h,k)=>h.localeCompare(k)),m=Math.max(0,...o.map(h=>h.revenuePence)),p=Math.max(m,100),b=900-a.left-a.right,f=320-a.top-a.bottom,g=h=>{const k=d.indexOf(h);return k<=0||d.length<=1?a.left:a.left+k/(d.length-1)*b},M=h=>a.top+(1-h/p)*f,y=4,E=Array.from({length:y+1}).map((h,k)=>Math.round(p/y*(y-k)));return s.jsxs("div",{className:"admin-sales-chart-inner",children:[s.jsxs("svg",{viewBox:"0 0 900 320",className:"admin-sales-chart-svg",role:"img","aria-label":"Sales revenue chart",children:[E.map(h=>s.jsxs("g",{children:[s.jsx("line",{x1:a.left,y1:M(h),x2:900-a.right,y2:M(h),className:"admin-sales-grid-line"}),s.jsxs("text",{x:a.left-8,y:M(h)+4,textAnchor:"end",className:"admin-sales-axis-label",children:["£",Math.round(h/100)]})]},`tick-${h}`)),e.map((h,k)=>{const he=h.points.map((O,ne)=>`${ne===0?"M":"L"} ${g(O.date)} ${M(O.revenuePence)}`).join(" ");return s.jsxs("g",{children:[s.jsx("path",{d:he,fill:"none",stroke:r[k%r.length],strokeWidth:"2"}),h.points.map(O=>s.jsx("circle",{cx:g(O.date),cy:M(O.revenuePence),r:"2.25",fill:r[k%r.length],children:s.jsx("title",{children:`${new Date(`${O.date}T00:00:00`).toLocaleDateString("en-GB")} · ${h.name}: ${H(O.revenuePence)}`})},`${h.key}-${O.date}`))]},h.key)}),d.filter((h,k)=>k%Math.max(1,Math.ceil(d.length/6))===0||k===d.length-1).map(h=>s.jsx("text",{x:g(h),y:308,textAnchor:"middle",className:"admin-sales-axis-label",children:new Date(`${h}T00:00:00`).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit"})},`x-${h}`))]}),s.jsx("div",{className:"admin-sales-legend",children:e.map((h,k)=>s.jsxs("span",{className:"admin-sales-legend-item",children:[s.jsx("i",{style:{background:r[k%r.length]}}),h.name]},`legend-${h.key}`))})]})}function ps(){const[e,t]=l.useState("products"),[n,a]=l.useState([]),[r,o]=l.useState(!1),[d,m]=l.useState(!1),[p,b]=l.useState(!1),[f,g]=l.useState(lt),[M,y]=l.useState(null),[E,h]=l.useState(null),[k,he]=l.useState([]),[O,ne]=l.useState(!1),[I,He]=l.useState(null),[U,ae]=l.useState("30"),[fe,R]=l.useState(()=>Xt("30").from),[X,w]=l.useState(()=>hs()),[_,se]=l.useState(!0),[Z,re]=l.useState([]),[Ne,$]=l.useState(!1),[q,z]=l.useState(null),[S,J]=l.useState(null),[pe,ke]=l.useState(!1),ie=l.useMemo(()=>[...n].sort((c,u)=>c.sortOrder-u.sortOrder||Date.parse(u.updatedAt)-Date.parse(c.updatedAt)),[n]),ge=l.useMemo(()=>{if(!S)return[];const c=[];_&&S.series.overall&&c.push({key:"overall",name:"Overall",points:S.series.overall});for(const u of S.series.products??[])c.push({key:u.productId,name:u.name,points:u.points.map(v=>({date:v.date,revenuePence:v.revenuePence}))});return c},[_,S]);async function K(){o(!0),y(null);try{const c=await fetch("/api/admin/shop/products"),u=await c.json();if(!c.ok)throw new Error(u.error||"Could not fetch products.");a(u.products)}catch(c){y(c instanceof Error?c.message:"Could not fetch products.")}finally{o(!1)}}async function G(){ne(!0),y(null);try{const c=await fetch("/api/admin/shop/orders"),u=await c.json();if(!c.ok)throw new Error(u.error||"Could not fetch orders.");he(u.orders)}catch(c){y(c instanceof Error?c.message:"Could not fetch orders.")}finally{ne(!1)}}async function oe(c){y(null);try{const u=await fetch(`/api/admin/shop/orders/${c}`),v=await u.json();if(!u.ok)throw new Error(v.error||"Could not fetch order details.");He(v.order)}catch(u){y(u instanceof Error?u.message:"Could not fetch order details.")}}async function Y(c){$(!0),z(null);const u=U,v=fe,C=X,P=new URLSearchParams;u==="custom"?(P.set("from",v),P.set("to",C)):P.set("range",u),_||P.set("includeOverall","false"),Z.length>0&&P.set("productIds",Z.join(","));try{const F=await fetch(`/api/admin/shop/sales?${P.toString()}`),Ee=await F.json();if(!F.ok)throw new Error(Ee.error||"Could not fetch sales analytics.");J(Ee)}catch(F){z(F instanceof Error?F.message:"Could not fetch sales analytics.")}finally{$(!1)}}l.useEffect(()=>{K()},[]),l.useEffect(()=>{e==="orders"&&G(),e==="sales"&&Y()},[e]),l.useEffect(()=>{e==="sales"&&Y()},[e,U,fe,X,_,Z.join(",")]),l.useEffect(()=>{if(e!=="orders")return;const c=window.setInterval(()=>{G(),I&&oe(I.id)},15e3);return()=>window.clearInterval(c)},[e,I]);function Se(){g(lt),b(!1)}function De(){g(lt),b(!0),y(null),h(null)}function Ce(c){g({id:c.id,name:c.name,description:c.description||"",priceGbp:(c.pricePence/100).toFixed(2),imageUrl:c.imageUrl||"",active:c.active,featured:c.featured,sortOrder:c.sortOrder}),b(!0),y(null),h(null)}async function Me(c){c.preventDefault(),y(null),h(null);const u=f.name.trim();if(!u){y("Name is required.");return}const v=ms(f.priceGbp);if(v<=0){y("Price must be greater than £0.00.");return}m(!0);try{const C=f.id?"/api/admin/shop/products/update":"/api/admin/shop/products/create",P=await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f.id,name:u,description:f.description.trim(),pricePence:v,imageUrl:f.imageUrl.trim(),active:f.active,featured:f.featured,sortOrder:f.sortOrder})}),F=await P.json();if(!P.ok)throw new Error(F.error||"Unable to save product.");await K(),h(f.id?"Product updated.":"Product created."),Se()}catch(C){y(C instanceof Error?C.message:"Unable to save product.")}finally{m(!1)}}async function Te(c,u,v){y(null),h(null);try{const C=await fetch("/api/admin/shop/products/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,field:u,value:v})}),P=await C.json();if(!C.ok)throw new Error(P.error||"Unable to update product.");await K(),h("Product updated.")}catch(C){y(C instanceof Error?C.message:"Unable to update product.")}}async function Oe(c){y(null),h(null);try{const u=await fetch("/api/admin/shop/products/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c})}),v=await u.json();if(!u.ok)throw new Error(v.error||"Unable to disable product.");await K(),h("Product disabled.")}catch(u){y(u instanceof Error?u.message:"Unable to disable product.")}}async function Ue(c){y(null),h(null);try{const u=await fetch(`/api/admin/shop/orders/${c}/collect`,{method:"POST"}),v=await u.json();if(!u.ok)throw new Error(v.error||"Unable to mark order as collected.");await G(),await oe(c),h("Order marked as collected.")}catch(u){y(u instanceof Error?u.message:"Unable to mark order as collected.")}}function Pe(c){re(u=>u.includes(c)?u.filter(v=>v!==c):u.length>=3?u:[...u,c])}function ce(c){const u=Xt(c);ae(c),R(u.from),w(u.to)}return s.jsxs("section",{className:"booking-shell","aria-live":"polite",children:[s.jsx("h2",{children:"Shop"}),s.jsxs("div",{className:"admin-view-tabs admin-view-tabs--three",role:"tablist","aria-label":"Shop sections",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${e==="products"?"admin-filter-tab--active":""}`,onClick:()=>t("products"),children:"Products"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${e==="orders"?"admin-filter-tab--active":""}`,onClick:()=>t("orders"),children:"Orders"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${e==="sales"?"admin-filter-tab--active":""}`,onClick:()=>t("sales"),children:"Sales"})]}),e==="products"&&s.jsxs("div",{className:"admin-reports admin-products-panel",children:[s.jsxs("div",{className:"admin-products-actions",children:[s.jsx("button",{type:"button",className:"btn btn--primary",onClick:De,children:"Add product"}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void K(),disabled:r,children:r?"Refreshing…":"Refresh"})]}),M?s.jsx("p",{className:"admin-inline-error",children:M}):null,E?s.jsx("p",{className:"admin-inline-success",children:E}):null,p?s.jsxs("form",{className:"admin-product-form",onSubmit:Me,children:[s.jsx("h3",{children:f.id?"Edit product":"Add product"}),s.jsxs("label",{children:["Name",s.jsx("input",{value:f.name,onChange:c=>g(u=>({...u,name:c.target.value})),required:!0})]}),s.jsxs("label",{children:["Description",s.jsx("textarea",{value:f.description,onChange:c=>g(u=>({...u,description:c.target.value})),rows:3})]}),s.jsxs("label",{children:["Price (GBP)",s.jsx("input",{type:"number",min:"0.01",step:"0.01",value:f.priceGbp,onChange:c=>g(u=>({...u,priceGbp:c.target.value})),required:!0})]}),s.jsxs("label",{children:["Image URL",s.jsx("input",{type:"url",value:f.imageUrl,onChange:c=>g(u=>({...u,imageUrl:c.target.value})),placeholder:"https://..."})]}),s.jsxs("label",{children:["Sort order",s.jsx("input",{type:"number",value:f.sortOrder,onChange:c=>g(u=>({...u,sortOrder:Number.parseInt(c.target.value,10)||0}))})]}),s.jsxs("label",{className:"admin-product-checkbox",children:[s.jsx("input",{type:"checkbox",checked:f.active,onChange:c=>g(u=>({...u,active:c.target.checked}))}),"Active"]}),s.jsxs("label",{className:"admin-product-checkbox",children:[s.jsx("input",{type:"checkbox",checked:f.featured,onChange:c=>g(u=>({...u,featured:c.target.checked}))}),"Featured"]}),s.jsxs("div",{className:"admin-products-actions",children:[s.jsx("button",{type:"submit",className:"btn btn--primary",disabled:d,children:d?"Saving…":"Save product"}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:Se,children:"Cancel"})]})]}):null,s.jsx("div",{className:"admin-products-table-wrap",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Price"}),s.jsx("th",{children:"Active"}),s.jsx("th",{children:"Featured"}),s.jsx("th",{children:"Sort"}),s.jsx("th",{children:"Updated"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:ie.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,children:"No products yet."})}):ie.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:c.name}),s.jsx("td",{children:H(c.pricePence)}),s.jsx("td",{children:c.active?"Yes":"No"}),s.jsx("td",{children:c.featured?"Yes":"No"}),s.jsx("td",{children:c.sortOrder}),s.jsx("td",{children:new Date(c.updatedAt).toLocaleString("en-GB")}),s.jsx("td",{children:s.jsxs("div",{className:"admin-products-row-actions",children:[s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>Ce(c),children:"Edit"}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void Te(c.id,"active",!c.active),children:c.active?"Deactivate":"Activate"}),s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void Te(c.id,"featured",!c.featured),children:c.featured?"Unfeature":"Feature"}),s.jsx("button",{type:"button",className:"btn btn--secondary",onClick:()=>void Oe(c.id),children:"Delete"})]})})]},c.id))})]})})]}),e==="orders"&&s.jsxs("div",{className:"admin-reports admin-orders-panel",children:[M?s.jsx("p",{className:"admin-inline-error",children:M}):null,E?s.jsx("p",{className:"admin-inline-success",children:E}):null,s.jsx("div",{className:"admin-products-actions",children:s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void G(),disabled:O,children:O?"Refreshing…":"Refresh orders"})}),s.jsx("div",{className:"admin-products-table-wrap",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Customer email"}),s.jsx("th",{children:"Total"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Items"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:k.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,children:"No orders yet."})}):k.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(c.createdAt).toLocaleString("en-GB")}),s.jsx("td",{children:c.customerEmail}),s.jsx("td",{children:H(c.totalPence)}),s.jsx("td",{children:c.status}),s.jsx("td",{children:c._count.items}),s.jsx("td",{children:s.jsx("button",{type:"button",className:"btn btn--ghost",onClick:()=>void oe(c.id),children:"View"})})]},c.id))})]})}),I?s.jsxs("article",{className:"admin-order-detail",children:[s.jsx("h3",{children:"Order details"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Email:"})," ",I.customerEmail]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Status:"})," ",I.status]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Total:"})," ",H(I.totalPence)]}),s.jsx("div",{className:"admin-products-table-wrap",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Item"}),s.jsx("th",{children:"Unit"}),s.jsx("th",{children:"Qty"}),s.jsx("th",{children:"Line total"})]})}),s.jsx("tbody",{children:I.items.map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:c.nameSnapshot}),s.jsx("td",{children:H(c.unitPricePenceSnapshot)}),s.jsx("td",{children:c.quantity}),s.jsx("td",{children:H(c.lineTotalPence)})]},c.id))})]})}),I.status==="PAID"?s.jsx("button",{type:"button",className:"btn btn--primary",onClick:()=>void Ue(I.id),children:"Mark as collected"}):null]}):null]}),e==="sales"&&s.jsxs("div",{className:"admin-reports admin-sales-panel",children:[q?s.jsx("p",{className:"admin-inline-error",children:q}):null,E?s.jsx("p",{className:"admin-inline-success",children:E}):null,s.jsxs("div",{className:"admin-sales-kpis",children:[s.jsxs("article",{className:"admin-sales-kpi",children:[s.jsx("p",{children:"Total revenue"}),s.jsx("strong",{children:H(S?.kpis.revenuePence??0)})]}),s.jsxs("article",{className:"admin-sales-kpi",children:[s.jsx("p",{children:"Orders count"}),s.jsx("strong",{children:S?.kpis.ordersCount??0})]}),s.jsxs("article",{className:"admin-sales-kpi",children:[s.jsx("p",{children:"Average order value"}),s.jsx("strong",{children:H(S?.kpis.avgOrderValuePence??0)})]}),s.jsxs("article",{className:"admin-sales-kpi",children:[s.jsx("p",{children:"Best-selling product"}),s.jsx("strong",{children:S?.kpis.bestProduct?`${S.kpis.bestProduct.name} (${H(S.kpis.bestProduct.revenuePence)})`:"—"})]})]}),s.jsxs("div",{className:"admin-sales-controls",children:[s.jsxs("div",{className:"admin-filter-tabs",role:"tablist","aria-label":"Sales range presets",children:[s.jsx("button",{type:"button",className:`admin-filter-tab ${U==="7"?"admin-filter-tab--active":""}`,onClick:()=>ce("7"),children:"Last 7 days"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${U==="30"?"admin-filter-tab--active":""}`,onClick:()=>ce("30"),children:"Last 30 days"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${U==="90"?"admin-filter-tab--active":""}`,onClick:()=>ce("90"),children:"Last 90 days"}),s.jsx("button",{type:"button",className:`admin-filter-tab ${U==="custom"?"admin-filter-tab--active":""}`,onClick:()=>ae("custom"),children:"Custom"})]}),U==="custom"?s.jsxs("div",{className:"admin-sales-custom-dates",children:[s.jsxs("label",{children:["From",s.jsx("input",{type:"date",value:fe,onChange:c=>R(c.target.value)})]}),s.jsxs("label",{children:["To",s.jsx("input",{type:"date",value:X,onChange:c=>w(c.target.value)})]})]}):null,s.jsxs("label",{className:"admin-product-checkbox",children:[s.jsx("input",{type:"checkbox",checked:_,onChange:c=>se(c.target.checked)}),"Include Overall line"]}),s.jsxs("div",{className:"admin-sales-product-picker",children:[s.jsx("p",{children:"Select products (max 3):"}),s.jsx("div",{className:"admin-sales-product-list",children:ie.filter(c=>c.active).map(c=>{const u=Z.includes(c.id),v=Z.length>=3&&!u;return s.jsxs("label",{className:"admin-product-checkbox",children:[s.jsx("input",{type:"checkbox",checked:u,disabled:v,onChange:()=>Pe(c.id)}),c.name]},c.id)})})]}),s.jsxs("div",{className:"admin-products-actions",children:[s.jsx("button",{type:"button",className:"btn btn--primary",onClick:()=>void Y(),disabled:Ne,children:Ne?"Loading…":"Refresh sales"}),null]})]}),(S?.kpis.ordersCount??0)===0?s.jsx("div",{className:"admin-sales-empty",children:s.jsx("p",{children:"No sales yet."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"admin-sales-chart-wrap",children:s.jsx(fs,{series:ge})}),s.jsx("div",{className:"admin-products-table-wrap",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Product"}),s.jsx("th",{children:"Units sold"}),s.jsx("th",{children:"Revenue (GBP)"})]})}),s.jsx("tbody",{children:(S?.leaderboard??[]).length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:3,children:"No paid order items in this range."})}):(S?.leaderboard??[]).map(c=>s.jsxs("tr",{children:[s.jsx("td",{children:c.name}),s.jsx("td",{children:c.units}),s.jsx("td",{children:H(c.revenuePence)})]},c.productId))})]})})]})]})]})}function Zt(){return typeof window>"u"?"bookings":new URLSearchParams(window.location.search).get("section")==="shop"?"shop":"bookings"}function ys(){const[e,t]=l.useState("bookings");l.useEffect(()=>{t(Zt());const a=()=>{t(Zt())};return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[]);const n=l.useCallback(a=>{t(a);const r=new URLSearchParams(window.location.search);r.set("section",a);const o=r.toString(),d=`${window.location.pathname}${o?`?${o}`:""}`;window.history.replaceState({},"",d)},[]);return s.jsxs(gn,{activeSection:e,onChangeSection:n,children:[s.jsx(us,{isActive:e==="bookings"}),e==="shop"?s.jsx(ps,{}):null]})}export{ys as default};
